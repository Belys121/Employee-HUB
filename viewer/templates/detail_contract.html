{% extends 'base.html' %}

{% block title %}
    SDA Employee Hub | Contract Detail
{% endblock %}

{% block content %}

    <a href="{% url 'navbar_contracts_all' %}" class="btn btn-custom">Zpět na přehled</a>
    <a href="{% url 'contract_update' contract.pk %}" class="btn btn-custom">Upravit</a>

<h2>Detail projektu č. {{ contract.id }}</h2>
<p>Název: {{ contract.contract_name }}</p>
<p>Datum vytvoření: {{ contract.created }}</p>
<p>Status: {{ contract.get_status_display }}</p>
<p>Uživatel: {{ contract.user.first_name }} {{ contract.user.last_name }}</p>

{% if contract.user.userprofile.position %}
    <p>Pozice: {{ contract.user.userprofile.position.name }}</p>
{% else %}
    <p>Pozice: Žádná pozice</p>
{% endif %}

<table class="table table-striped table-bordered">
        <thead>
            <tr>
                <th>Číslo podprojektu</th>
                <th>Jméno podprojekty</th>
                <th>Uživatel</th>
                <th>Status</th>
            </tr>
        </thead>
        <tbody>
            {% for subcontract in contract.subcontracts.all %}
            <tr>
                <td>{{ contract.pk }} _ {{subcontract.subcontract_number }}</td>
                <td>{{ subcontract.subcontract_name }}</td>
                <td>{{ subcontract.user }}</td>
                <td>{{ subcontract.get_status_display }}</td>
                <td><a href="{% url 'subcontract_detail' contract_pk=subcontract.contract.pk subcontract_number=subcontract.subcontract_number %}" class="btn btn-custom">Detail podprojektu</a></td>
                {% if subcontract.subcontract_number %}
                <td><a href="{% url 'subcontract_update' contract_pk=subcontract.contract.pk subcontract_number=subcontract.subcontract_number %}" class="btn btn-custom">Upravit</a></td>
                {% else %}
                <td><span class="text-danger">Missing subcontract number</span></td>
                {% endif %}
                <td><a href="{% url 'subcontract_delete' subcontract.pk %}" class="btn btn-custom">Smazat</a></td>

            </tr>
            {% endfor %}

        </tbody>
    </table>

   <a href="{% url 'subcontract_create' contract.pk %}" class="btn btn-custom"> Přidat položku </a>
{% endblock %}