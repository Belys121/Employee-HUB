{% load static %}

<!--Tabulka se všemi projekty, kterou najdeme na url /navbar_contracts_all/-->
<head>
    <link rel="stylesheet" href="{% static 'buttons.css' %}">
</head>
<h2>Všechny projekty</h2>
    <a href="{% url 'homepage' %}" class="btn btn-custom">Zpět na homepage</a>
    <a href="{% url 'contract_create' %}" class="btn btn-custom"> Nový projekt </a>
  <ul>
<table class="table table-striped table-bordered">
    <thead>
        <tr>
            <th>Název projektu</th>
            <th>Číslo projektu</th>
            <th>Datum vytvoření</th>
            <th>Deadline</th>
            <th>Zbývá dní</th>
            <th>Status</th>
            <th>Uživatel</th>
            <th>Pozice</th>
            <th>Počet podprojektů</th>
            <th>Detail projektu</th>
        </tr>
    </thead>
    <tbody>
        {% for contract in contracts %}
        <tr>
            <td>{{ contract.contract_name }}</td>
            <td align="center">{{ contract.id }}</td>
            <td>{{ contract.created|date:"Y M d" }}</td>
            <td>{{ contract.deadline|date:"Y M d" }}</td>
            <td align="center">{{ contract.delta }}</td>
            <td>{{ contract.get_status_display }}</td>
            <td>{{ contract.user.first_name }} {{ contract.user.last_name }}</td>
            <td>
                {% if contract.user.userprofile.position %}
                    {{ contract.user.userprofile.position.name }}
                {% else %}
                    Žádná pozice
                {% endif %}
            </td>
            <td align="center">{{ contract.subcontracts.count }}</td>
            <td>
                <a href="{% url 'contract_detail' contract.id %}" class="btn btn-custom">Detail projektu</a>
            </td>
            <td>
                <a href="{% url 'contract_update' contract.pk %}" class="btn btn-custom">Upravit</a>
            </td>
            <td>
                <a href="{% url 'contract_delete' contract.pk %}" class="btn btn-custom">Smazat</a>
            </td>
        </tr>
        {% empty %}
        <tr>
            <td colspan="6">Žádné projekty nejsou dostupné.</td>
        </tr>
        {% endfor %}
    </tbody>
</table>

